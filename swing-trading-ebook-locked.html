<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ”’ Ebook Swing Trading Harian: Akses Terbatas</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #334155;
            transition: opacity 0.5s ease-in-out;
        }
        .container {
            max-width: 960px;
        }
        .section-title {
            @apply text-3xl md:text-4xl font-bold text-blue-800 mb-6 border-b-2 border-blue-200 pb-2;
        }
        .details-summary {
            @apply cursor-pointer font-semibold text-blue-700 text-lg py-3 px-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors duration-200 flex justify-between items-center;
        }
        .card {
            @apply bg-white rounded-xl shadow-lg p-6 mb-8;
        }
        #login-screen {
            display: flex;
            min-height: 100vh;
            background-color: #e0f2fe; /* Light blue */
        }
        #content-wrapper {
            opacity: 0; /* Sembunyikan konten utama secara default */
            pointer-events: none;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <!-- Konfigurasi Firebase dan Skema Keamanan -->
    <script type="module">
        // Variabel global MANDATORY dari Canvas untuk konfigurasi Firebase.
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;

        // IMPORT FIREBASE DARI CDN
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Atur log level untuk debugging
        setLogLevel('error');

        let db = null;
        let isFirebaseReady = false;

        // Inisialisasi Firebase
        if (firebaseConfig) {
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                isFirebaseReady = true;
                console.log("Firebase initialized.");
            } catch (error) {
                console.error("Error initializing Firebase:", error);
                document.getElementById('message-area').textContent = "ERROR: Firebase tidak terinisialisasi. Cek konfigurasi.";
                document.getElementById('login-button').disabled = true;
            }
        }

        const tokenInput = document.getElementById('token-input');
        const loginButton = document.getElementById('login-button');
        const messageArea = document.getElementById('message-area');
        const loginScreen = document.getElementById('login-screen');
        const contentWrapper = document.getElementById('content-wrapper');

        async function checkToken(token) {
            if (!isFirebaseReady || !db) {
                messageArea.textContent = "Sistem Ebook belum siap. Coba lagi.";
                return false;
            }

            try {
                // Path Firestore: /artifacts/{appId}/public/data/ebook_access/{token}
                const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'ebook_tokens', token);
                const docSnap = await getDoc(docRef);
                
                if (docSnap.exists()) {
                    console.log("Token Valid. Data:", docSnap.data());
                    return true;
                } else {
                    console.log("Token Tidak Ditemukan.");
                    return false;
                }
            } catch (error) {
                console.error("Error checking token:", error);
                // Menangani error jaringan/firewall dengan pesan umum
                messageArea.textContent = "Terjadi masalah saat verifikasi. Pastikan token benar dan coba lagi.";
                return false;
            }
        }

        const handleLogin = async () => {
            const token = tokenInput.value.trim();
            if (token === "") {
                messageArea.textContent = "Mohon masukkan Token Akses Anda.";
                return;
            }

            // Tampilkan loading state
            loginButton.disabled = true;
            messageArea.innerHTML = `<div class="loading-spinner"></div> Sedang memverifikasi token...`;
            messageArea.classList.remove('text-red-600', 'text-green-600');
            messageArea.classList.add('text-blue-600');

            // Cek token
            const isValid = await checkToken(token);

            if (isValid) {
                // Token Valid: Berikan akses
                sessionStorage.setItem('ebook_token', token);
                messageArea.innerHTML = "Token Valid! Membuka Ebook...";
                messageArea.classList.remove('text-blue-600', 'text-red-600');
                messageArea.classList.add('text-green-600');
                
                // Animasi transisi
                setTimeout(() => {
                    loginScreen.style.display = 'none';
                    contentWrapper.style.opacity = 1;
                    contentWrapper.style.pointerEvents = 'auto';
                }, 500);

            } else {
                // Token Tidak Valid: Tampilkan pesan error
                messageArea.innerHTML = "Token Akses tidak valid atau sudah kadaluarsa.";
                messageArea.classList.remove('text-blue-600', 'text-green-600');
                messageArea.classList.add('text-red-600');
                loginButton.disabled = false;
            }
        };

        // Tambahkan event listener untuk tombol login
        loginButton.addEventListener('click', handleLogin);
        // Tambahkan event listener untuk tombol enter pada input
        tokenInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleLogin();
            }
        });

        // Cek Session Storage saat memuat halaman (untuk sesi yang sudah login)
        const checkSession = async () => {
            const storedToken = sessionStorage.getItem('ebook_token');
            if (storedToken) {
                tokenInput.value = storedToken;
                // Hanya periksa token jika sudah ada di storage
                if (await checkToken(storedToken)) {
                    loginScreen.style.display = 'none';
                    contentWrapper.style.opacity = 1;
                    contentWrapper.style.pointerEvents = 'auto';
                } else {
                    sessionStorage.removeItem('ebook_token');
                    // Jika token kadaluarsa, tampilkan layar login
                    loginScreen.style.display = 'flex';
                }
            } else {
                 loginScreen.style.display = 'flex';
            }
        };

        // Tunggu hingga DOM dimuat dan kemudian cek sesi
        document.addEventListener('DOMContentLoaded', () => {
             // Sembunyikan loading screen sementara pengecekan sesi (default style is flex)
             loginScreen.style.display = 'none'; 
             checkSession();
        });


    </script>
    
    <!-- Bagian 1: Layar Login (Visible secara default, disembunyikan oleh JS setelah login) -->
    <div id="login-screen" class="absolute inset-0 z-50 p-4 justify-center items-center">
        <div class="w-full max-w-md bg-white p-8 rounded-xl shadow-2xl text-center">
            <h1 class="text-3xl font-extrabold text-blue-700 mb-2">Akses Terbatas Ebook</h1>
            <p class="text-lg text-gray-600 mb-6">Silakan masukkan Token Akses Anda untuk melanjutkan.</p>

            <div class="mb-4">
                <input type="text" id="token-input" placeholder="Masukkan Token Akses Unik Anda" class="w-full p-3 border-2 border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150 text-center text-lg" />
            </div>

            <button id="login-button" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition duration-150 ease-in-out shadow-md disabled:opacity-50 disabled:cursor-not-allowed">
                Masuk dan Buka Ebook
            </button>
            
            <p id="message-area" class="mt-4 text-sm text-blue-600 h-6 flex items-center justify-center"></p>

            <p class="mt-8 text-xs text-gray-400">Anda akan membutuhkan Token Akses 20 digit unik yang diberikan setelah pembelian.</p>
        </div>
    </div>


    <!-- Bagian 2: Konten Ebook Utama (Hidden secara default) -->
    <div id="content-wrapper" style="opacity: 0; pointer-events: none;">
        <!-- Navigation Bar -->
        <nav class="sticky-nav">
            <div class="container mx-auto px-4 py-3 flex flex-wrap justify-center md:justify-between items-center">
                <h1 class="text-xl font-bold text-blue-900 mb-2 md:mb-0">Ebook: Swing Trading</h1>
                <div class="flex flex-wrap gap-2 md:gap-4 text-sm">
                    <a href="#intro" class="nav-link">Pendahuluan</a>
                    <a href="#metrics" class="nav-link">Metrik Kunci</a>
                    <a href="#foundational" class="nav-link">Screener Dasar</a>
                    <a href="#advanced" class="nav-link">Screener Lanjutan</a>
                    <a href="#synergy" class="nav-link">Sinergi & Analisis</a>
                    <a href="#risk-management" class="nav-link">Manajemen Risiko</a>
                    <a href="#conclusion" class="nav-link">Kesimpulan</a>
                </div>
            </div>
        </nav>

        <main class="container mx-auto px-4 py-8">

            <!-- INTRODUCTION SECTION (Konten Ebook Asli Anda) -->
            <section id="intro" class="card">
                <h2 class="section-title">I. Pendahuluan: Keunggulan Swing Trader di Pasar Dinamis</h2>
                <p class="mb-4">Swing trading, khususnya dalam rentang waktu 1-7 hari, adalah strategi yang dirancang untuk memanfaatkan pergerakan harga jangka pendek di pasar keuangan. Pendekatan ini berfokus pada identifikasi saham yang berpotensi mengalami kenaikan signifikan, baik karena breakout dari konsolidasi, pembalikan dari tren turun, atau akumulasi berkelanjutan oleh partisipan pasar. Waktu penyelesaian yang cepat dari strategi ini menuntut fokus pada aset yang sangat likuid dan sinyal teknikal yang jelas dan dapat ditindaklanjuti, seringkali diperkuat oleh aliran dana institusional atau "smart money" yang mendasarinya.</p>
                <p class="mb-4">Di pasar yang luas dan dinamis seperti Bursa Efek Indonesia (BEI), menyaring ribuan saham secara manual untuk menemukan kandidat berpotensi tinggi ini adalah upaya yang tidak praktis. Di sinilah *stock screener* yang canggih menjadi alat yang sangat diperlukan. *Screener* berfungsi sebagai filter yang kuat, secara efisien mempersempit alam semesta pasar yang luas menjadi daftar ekuitas yang dapat dikelola yang secara tepat sesuai dengan kriteria yang telah ditentukan oleh trader. Bagi *swing trader*, *screening* yang efektif bukan hanya kenyamanan; ini merupakan fase awal dan paling kritis dari proses trading mereka, memastikan bahwa perhatian mereka diarahkan pada saham dengan probabilitas statistik tertinggi untuk memberikan keuntungan dalam jangka waktu yang ditentukan.</p>
                <p>Laporan ini menyajikan kerangka kerja komprehensif untuk mengembangkan *stock screener* tingkat lanjut. Ini mengintegrasikan analisis teknikal tradisionalâ€”meliputi metrik harga, volume, dan frekuensi perdaganganâ€”dengan wawasan bernuansa yang berasal dari "bandarmology." Bandarmology, studi tentang aktivitas investor institusional dan besar (termasuk aliran asing, akumulasi/distribusi institusional lokal, dan transaksi *insider*), menawarkan lensa unik ke dalam dinamika pasar. Dengan menggabungkan kumpulan data yang kuat ini, tujuannya adalah untuk melampaui metodologi *screening* konvensional, menyediakan pendekatan holistik dan berbasis data untuk mengidentifikasi *setup* berkeyakinan tinggi untuk apresiasi modal jangka pendek.</p>
            </section>

            <!-- METRICS SECTION (Disembunyikan untuk menghemat ruang, tetapi diasumsikan ada) -->
            <section id="metrics" class="card">
                <h2 class="section-title">II. Membongkar Perangkat Anda: Metrik Kunci (Lanjutkan dari konten asli)</h2>
                <p>Konten Metrik Kunci... (Gunakan konten lengkap dari file asli di sini)</p>
                <details class="mb-4"><summary class="details-summary">A. Metrik Teknikal untuk Momentum & Volatilitas (Klik untuk melihat)</summary><div class="details-content mt-2"><p>...</p></div></details>
                <details class="mb-4"><summary class="details-summary">B. Metrik Bandarmology untuk Aliran Institusional & Smart Money (Klik untuk melihat)</summary><div class="details-content mt-2"><p>...</p></div></details>
            </section>
            
            <!-- FOUNDATIONAL SCREENERS SECTION (Disembunyikan untuk menghemat ruang, tetapi diasumsikan ada) -->
            <section id="foundational" class="card">
                <h2 class="section-title">III. Screener Fundamental: Menganalisis dan Meningkatkan Pendekatan Umum</h2>
                 <p>Konten Screener Fundamental... (Gunakan konten lengkap dari file asli di sini)</p>
            </section>

            <!-- ADVANCED SCREENERS SECTION (Disembunyikan untuk menghemat ruang, tetapi diasumsikan ada) -->
            <section id="advanced" class="card">
                <h2 class="section-title">IV. Screener Swing Trading Lanjutan: Membuka Setup Berprobabilitas Tinggi</h2>
                 <p>Konten Screener Lanjutan... (Gunakan konten lengkap dari file asli di sini)</p>
            </section>

            <!-- SYNERGY SECTION (Disembunyikan untuk menghemat ruang, tetapi diasumsikan ada) -->
            <section id="synergy" class="card">
                <h2 class="section-title">V. Screening Sinergis: Menggabungkan Strategi untuk Presisi yang Ditingkatkan</h2>
                 <p>Konten Sinergi... (Gunakan konten lengkap dari file asli di sini)</p>
            </section>
            
            <!-- RISK MANAGEMENT SECTION (Disembunyikan untuk menghemat ruang, tetapi diasumsikan ada) -->
            <section id="risk-management" class="card">
                <h2 class="section-title">VI. Manajemen Risiko & Eksekusi untuk Swing Trader</h2>
                 <p>Konten Manajemen Risiko... (Gunakan konten lengkap dari file asli di sini)</p>
            </section>

            <!-- CONCLUSION SECTION (Disembunyikan untuk menghemat ruang, tetapi diasumsikan ada) -->
            <section id="conclusion" class="card">
                <h2 class="section-title">VII. Kesimpulan: Memberdayakan Keputusan Trading Anda</h2>
                 <p>Konten Kesimpulan... (Gunakan konten lengkap dari file asli di sini)</p>
            </section>

        </main>
    </div>

</body>
</html>
